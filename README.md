# Replit Deployments Setup - إعداد النشر

## نظرة عامة
هذا النظام محسن خصيصاً لـ Replit Deployments كـ Background Worker لتشغيل البوتات بشكل مستمر.

## خطوات النشر

### 1. إعداد الأسرار (Deployment Secrets)
في إعدادات النشر، أضف المتغيرات التالية:

- `DISCORD_BOT_TOKEN` - توكن بوت الصور الرمزية
- `CONTROL_BOT_TOKEN` - توكن بوت التحكم  
- `CONSOLE_BOT_TOKEN` - توكن بوت وحدة التحكم
- `PUBLISHING_BOT_TOKEN` - توكن بوت النشر
- `TAG_SEARCH_BOT_TOKEN` - توكن بوت البحث بالعلامات

### 2. إعدادات النشر

**نوع التطبيق:** Background Worker
**أمر البناء:** `pip install -r requirements.txt`
**أمر التشغيل:** `python3 deploy_bots.py`

#### إصلاح مشكلة متغير $file
إذا واجهت خطأ "invalid run command variable '$file'":

**الحلول المتاحة:**
1. **الحل الأساسي:** `python3 deploy_bots.py`
2. **حل بديل 1:** `python3 start.py`
3. **حل بديل 2:** `bash run.sh`

#### إعدادات إضافية
- **فحص الحالة:** معطل (Discord bots لا تقدم HTTP)
- **إعادة التشغيل:** تلقائي
- **الموارد:** 1-2 CPU cores, 1-2 GB RAM

### 3. نوع الآلة الموصى به
- **Reserved VM Deployment** للتشغيل المستمر
- **CPU:** 1-2 cores كافية للبوتات
- **RAM:** 1-2 GB كافية للبوتات المتعددة

## الملفات الرئيسية

- `deploy_bots.py` - الملف الرئيسي للنشر
- `deployment_stats.json` - إحصائيات النشر
- `deployment.log` - سجلات النشر

## المميزات

✅ **تشغيل مستمر:** البوتات تعمل 24/7 بدون انقطاع
✅ **استرداد تلقائي:** إعادة تشغيل تلقائية عند التعطل
✅ **مراقبة متقدمة:** فحص دوري كل 30 ثانية
✅ **إيقاف صحيح:** التعامل السليم مع إشارات الإيقاف
✅ **إحصائيات مفصلة:** تتبع كامل للأداء والأخطاء

## المراقبة

- **السجلات:** متاحة في لوحة النشر
- **الإحصائيات:** محفوظة في `deployment_stats.json`
- **التقارير:** كل دقيقة في السجلات

## استكشاف الأخطاء

1. **لا توجد بوتات تعمل:** تحقق من الأسرار في إعدادات النشر
2. **إعادة تشغيل متكررة:** تحقق من صحة التوكنات
3. **أخطاء في السجلات:** راجع `deployment.log` لتفاصيل الأخطاء

## التحديث

لتحديث النظام:
1. قم بدفع التغييرات للمستودع
2. أعد نشر التطبيق من لوحة Deployments
3. البوتات ستُعاد تشغيلها تلقائياً